"use client";

import { useEffect, useState } from "react";
import CountResults from "@/components/ui/CountResults";
import ActivityCard from "@/components/ui/Experience/ActivityCard";
import ActivitySlider from "@/components/ui/Experience/ActivitySlider";
import ExperienceHero from "@/components/ui/Experience/ExperienceHero";
import RestaurantIconsFilter from "@/components/ui/Experience/RestaurantIconsFilter";
import MagazineListing from "@/components/ui/MagazineListing";
import SeeMore from "@/components/ui/SeeMore";
import { FaTree, FaHome, FaUsers, FaMountain, FaSpa, FaHeart, FaSmile, FaLandmark, FaConciergeBell } from "react-icons/fa";
import { useSearchParams } from "next/navigation";
import ActivityCardSkeleton from "@/components/skeletons/ActivityCardSkeleton";

export type Event = {
    _id: string;
    slug: string;
    name: string;
    time: string;
    persons: string;
    location: string;
    images: string[];
};

type SearchParams = {
    location?: string;
    openingTime?: string;
    feature?: string;
    page?: string;
};

export default function Page({ searchParams }: { searchParams:SearchParams}) {

    const [data, setData] = useState<any>(null);
    const [isLoading, setIsLoading] = useState(true);

    const icons = [
        { name: "Fun", svg: '<svg xmlns="http://www.w3.org/2000/svg" width="23" height="21" viewBox="0 0 23 21" fill="none"><path d="M0.833984 20.5354L5.83398 6.5354L14.834 15.5354L0.833984 20.5354ZM4.13398 17.2354L11.184 14.7354L6.63399 10.1854L4.13398 17.2354ZM13.384 11.0854L12.334 10.0354L17.934 4.4354C18.4673 3.90207 19.109 3.6354 19.859 3.6354C20.609 3.6354 21.2507 3.90207 21.784 4.4354L22.384 5.0354L21.334 6.0854L20.734 5.4854C20.5007 5.25207 20.209 5.1354 19.859 5.1354C19.509 5.1354 19.2173 5.25207 18.984 5.4854L13.384 11.0854ZM9.38399 7.0854L8.33398 6.0354L8.93398 5.4354C9.16732 5.20207 9.28399 4.91873 9.28399 4.5854C9.28399 4.25207 9.16732 3.96873 8.93398 3.7354L8.28399 3.0854L9.33399 2.0354L9.98398 2.6854C10.5173 3.21873 10.784 3.85207 10.784 4.5854C10.784 5.31873 10.5173 5.95207 9.98398 6.4854L9.38399 7.0854ZM11.384 9.0854L10.334 8.0354L13.934 4.4354C14.1673 4.20207 14.284 3.9104 14.284 3.5604C14.284 3.2104 14.1673 2.91873 13.934 2.6854L12.334 1.0854L13.384 0.0354004L14.984 1.6354C15.5173 2.16873 15.784 2.8104 15.784 3.5604C15.784 4.3104 15.5173 4.95207 14.984 5.4854L11.384 9.0854ZM15.384 13.0854L14.334 12.0354L15.934 10.4354C16.4673 9.90207 17.109 9.6354 17.859 9.6354C18.609 9.6354 19.2507 9.90207 19.784 10.4354L21.384 12.0354L20.334 13.0854L18.734 11.4854C18.5007 11.2521 18.209 11.1354 17.859 11.1354C17.509 11.1354 17.2173 11.2521 16.984 11.4854L15.384 13.0854Z" fill="#666D80"/></svg>' },
        { name: "Outdoor", svg: '<svg xmlns="http://www.w3.org/2000/svg" width="23" height="21" viewBox="0 0 23 21" fill="none"><path d="M0.833984 20.5354L5.83398 6.5354L14.834 15.5354L0.833984 20.5354ZM4.13398 17.2354L11.184 14.7354L6.63399 10.1854L4.13398 17.2354ZM13.384 11.0854L12.334 10.0354L17.934 4.4354C18.4673 3.90207 19.109 3.6354 19.859 3.6354C20.609 3.6354 21.2507 3.90207 21.784 4.4354L22.384 5.0354L21.334 6.0854L20.734 5.4854C20.5007 5.25207 20.209 5.1354 19.859 5.1354C19.509 5.1354 19.2173 5.25207 18.984 5.4854L13.384 11.0854ZM9.38399 7.0854L8.33398 6.0354L8.93398 5.4354C9.16732 5.20207 9.28399 4.91873 9.28399 4.5854C9.28399 4.25207 9.16732 3.96873 8.93398 3.7354L8.28399 3.0854L9.33399 2.0354L9.98398 2.6854C10.5173 3.21873 10.784 3.85207 10.784 4.5854C10.784 5.31873 10.5173 5.95207 9.98398 6.4854L9.38399 7.0854ZM11.384 9.0854L10.334 8.0354L13.934 4.4354C14.1673 4.20207 14.284 3.9104 14.284 3.5604C14.284 3.2104 14.1673 2.91873 13.934 2.6854L12.334 1.0854L13.384 0.0354004L14.984 1.6354C15.5173 2.16873 15.784 2.8104 15.784 3.5604C15.784 4.3104 15.5173 4.95207 14.984 5.4854L11.384 9.0854ZM15.384 13.0854L14.334 12.0354L15.934 10.4354C16.4673 9.90207 17.109 9.6354 17.859 9.6354C18.609 9.6354 19.2507 9.90207 19.784 10.4354L21.384 12.0354L20.334 13.0854L18.734 11.4854C18.5007 11.2521 18.209 11.1354 17.859 11.1354C17.509 11.1354 17.2173 11.2521 16.984 11.4854L15.384 13.0854Z" fill="#666D80"/></svg>' },
        { name: "Indoor", svg: '<svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 25 25" fill="none"><mask id="mask0_155_3997" style="maskType: alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="25" height="25"><rect x="0.833984" y="0.5354" width="24" height="24" fill="#D9D9D9"/></mask><g mask="url(#mask0_155_3997)"><path d="M4.83438 20.5354V11.1604L3.03438 12.5354L1.85938 10.9604L12.8344 2.5354L23.8344 10.9354L22.6344 12.5354L12.8344 5.0354L6.83437 9.6354V18.5354H10.8344V20.5354H4.83438ZM18.3344 22.9104C17.6344 23.3937 16.8635 23.5979 16.0219 23.5229C15.1802 23.4479 14.4594 23.1104 13.8594 22.5104C13.2594 21.9104 12.9219 21.1896 12.8469 20.3479C12.7719 19.5062 12.976 18.7354 13.4594 18.0354C12.976 17.3354 12.7719 16.5646 12.8469 15.7229C12.9219 14.8812 13.2594 14.1604 13.8594 13.5604C14.4594 12.9604 15.1802 12.6229 16.0219 12.5479C16.8635 12.4729 17.6344 12.6771 18.3344 13.1604C19.0344 12.6771 19.8052 12.4729 20.6469 12.5479C21.4885 12.6229 22.2094 12.9604 22.8094 13.5604C23.4094 14.1604 23.7469 14.8812 23.8219 15.7229C23.8969 16.5646 23.6927 17.3354 23.2094 18.0354C23.6927 18.7354 23.8969 19.5062 23.8219 20.3479C23.7469 21.1896 23.4094 21.9104 22.8094 22.5104C22.2094 23.1104 21.4885 23.4479 20.6469 23.5229C19.8052 23.5979 19.0344 23.3937 18.3344 22.9104ZM18.3344 20.4604L19.4844 21.2604C19.7844 21.4771 20.1094 21.5687 20.4594 21.5354C20.8094 21.5021 21.1177 21.3521 21.3844 21.0854C21.651 20.8187 21.801 20.5104 21.8344 20.1604C21.8677 19.8104 21.776 19.4854 21.5594 19.1854L20.7594 18.0354L21.5594 16.8854C21.776 16.5854 21.8677 16.2604 21.8344 15.9104C21.801 15.5604 21.651 15.2521 21.3844 14.9854C21.1177 14.7187 20.8094 14.5687 20.4594 14.5354C20.1094 14.5021 19.7844 14.5937 19.4844 14.8104L18.3344 15.6104L17.1844 14.8104C16.8844 14.5937 16.5594 14.5021 16.2094 14.5354C15.8594 14.5687 15.551 14.7187 15.2844 14.9854C15.0177 15.2521 14.8677 15.5604 14.8344 15.9104C14.801 16.2604 14.8927 16.5854 15.1094 16.8854L15.9094 18.0354L15.1094 19.1854C14.8927 19.4854 14.801 19.8104 14.8344 20.1604C14.8677 20.5104 15.0177 20.8187 15.2844 21.0854C15.551 21.3521 15.8594 21.5021 16.2094 21.5354C16.5594 21.5687 16.8844 21.4771 17.1844 21.2604L18.3344 20.4604ZM18.3344 19.2854C18.6844 19.2854 18.9802 19.1646 19.2219 18.9229C19.4635 18.6812 19.5844 18.3854 19.5844 18.0354C19.5844 17.6854 19.4635 17.3896 19.2219 17.1479C18.9802 16.9062 18.6844 16.7854 18.3344 16.7854C17.9844 16.7854 17.6885 16.9062 17.4469 17.1479C17.2052 17.3896 17.0844 17.6854 17.0844 18.0354C17.0844 18.3854 17.2052 18.6812 17.4469 18.9229C17.6885 19.1646 17.9844 19.2854 18.3344 19.2854Z" fill="#666D80"/></g></svg>' },
        { name: "Family Friendly", svg: '<svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 25 25" fill="none"><mask id="mask0_163_3205" style="maskType: alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="25" height="25"><rect x="0.833984" y="0.5354" width="24" height="24" fill="#D9D9D9"/></mask><g mask="url(#mask0_163_3205)"><path d="M12.834 16.5354C13.634 16.5354 14.3465 16.2979 14.9715 15.8229C15.5965 15.3479 16.0507 14.7354 16.334 13.9854H9.33398C9.61732 14.7354 10.0715 15.3479 10.6965 15.8229C11.3215 16.2979 12.034 16.5354 12.834 16.5354ZM10.334 12.5354C10.7507 12.5354 11.1048 12.3896 11.3965 12.0979C11.6882 11.8062 11.834 11.4521 11.834 11.0354C11.834 10.6187 11.6882 10.2646 11.3965 9.9729C11.1048 9.68123 10.7507 9.5354 10.334 9.5354C9.91732 9.5354 9.56315 9.68123 9.27148 9.9729C8.97982 10.2646 8.83398 10.6187 8.83398 11.0354C8.83398 11.4521 8.97982 11.8062 9.27148 12.0979C9.56315 12.3896 9.91732 12.5354 10.334 12.5354ZM15.334 12.5354C15.7507 12.5354 16.1048 12.3896 16.3965 12.0979C16.6882 11.8062 16.834 11.4521 16.834 11.0354C16.834 10.6187 16.6882 10.2646 16.3965 9.9729C16.1048 9.68123 15.7507 9.5354 15.334 9.5354C14.9173 9.5354 14.5632 9.68123 14.2715 9.9729C13.9798 10.2646 13.834 10.6187 13.834 11.0354C13.834 11.4521 13.9798 11.8062 14.2715 12.0979C14.5632 12.3896 14.9173 12.5354 15.334 12.5354ZM8.45898 6.9354L11.259 3.3104C11.459 3.04373 11.6965 2.8479 11.9715 2.7229C12.2465 2.5979 12.534 2.5354 12.834 2.5354C13.134 2.5354 13.4215 2.5979 13.6965 2.7229C13.9715 2.8479 14.209 3.04373 14.409 3.3104L17.209 6.9354L21.459 8.3604C21.8923 8.49373 22.234 8.73957 22.484 9.0979C22.734 9.45623 22.859 9.85207 22.859 10.2854C22.859 10.4854 22.8298 10.6854 22.7715 10.8854C22.7132 11.0854 22.6173 11.2771 22.484 11.4604L19.734 15.3604L19.834 19.4604C19.8507 20.0437 19.659 20.5354 19.259 20.9354C18.859 21.3354 18.3923 21.5354 17.859 21.5354C17.8257 21.5354 17.6423 21.5104 17.309 21.4604L12.834 20.2104L8.35898 21.4604C8.27565 21.4937 8.18398 21.5146 8.08398 21.5229C7.98398 21.5312 7.89232 21.5354 7.80898 21.5354C7.27565 21.5354 6.80898 21.3354 6.40898 20.9354C6.00898 20.5354 5.81732 20.0437 5.83398 19.4604L5.93398 15.3354L3.20898 11.4604C3.07565 11.2771 2.97982 11.0854 2.92148 10.8854C2.86315 10.6854 2.83398 10.4854 2.83398 10.2854C2.83398 9.86873 2.95482 9.48123 3.19648 9.1229C3.43815 8.76457 3.77565 8.5104 4.20898 8.3604L8.45898 6.9354ZM9.68398 8.6604L4.83398 10.2604L7.93398 14.7354L7.83398 19.5104L12.834 18.1354L17.834 19.5354L17.734 14.7354L20.834 10.3104L15.984 8.6604L12.834 4.5354L9.68398 8.6604Z" fill="#666D80"/></g></svg>' },
        { name: "Extreme", svg: '<svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 25 25" fill="none"><mask id="mask0_155_4009" style="maskType: alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="25" height="25"><rect x="0.833984" y="0.5354" width="24" height="24" fill="#D9D9D9"/></mask><g mask="url(#mask0_155_4009)"><path d="M12.834 17.5354C13.1173 17.5354 13.3548 17.4396 13.5465 17.2479C13.7382 17.0562 13.834 16.8187 13.834 16.5354C13.834 16.2521 13.7382 16.0146 13.5465 15.8229C13.3548 15.6312 13.1173 15.5354 12.834 15.5354C12.5507 15.5354 12.3132 15.6312 12.1215 15.8229C11.9298 16.0146 11.834 16.2521 11.834 16.5354C11.834 16.8187 11.9298 17.0562 12.1215 17.2479C12.3132 17.4396 12.5507 17.5354 12.834 17.5354ZM11.834 13.5354H13.834V7.5354H11.834V13.5354ZM5.83398 21.5354C5.28398 21.5354 4.81315 21.3396 4.42148 20.9479C4.02982 20.5562 3.83398 20.0854 3.83398 19.5354V5.5354C3.83398 4.9854 4.02982 4.51457 4.42148 4.1229C4.81315 3.73123 5.28398 3.5354 5.83398 3.5354H10.034C10.2507 2.9354 10.6132 2.45207 11.1215 2.0854C11.6298 1.71873 12.2007 1.5354 12.834 1.5354C13.4673 1.5354 14.0382 1.71873 14.5465 2.0854C15.0548 2.45207 15.4173 2.9354 15.634 3.5354H19.834C20.384 3.5354 20.8548 3.73123 21.2465 4.1229C21.6382 4.51457 21.834 4.9854 21.834 5.5354V19.5354C21.834 20.0854 21.6382 20.5562 21.2465 20.9479C20.8548 21.3396 20.384 21.5354 19.834 21.5354H5.83398ZM5.83398 19.5354H19.834V5.5354H5.83398V19.5354ZM12.834 4.7854C13.0507 4.7854 13.2298 4.71457 13.3715 4.5729C13.5132 4.43123 13.584 4.25207 13.584 4.0354C13.584 3.81873 13.5132 3.63957 13.3715 3.4979C13.2298 3.35623 13.0507 3.2854 12.834 3.2854C12.6173 3.2854 12.4382 3.35623 12.2965 3.4979C12.1548 3.63957 12.084 3.81873 12.084 4.0354C12.084 4.25207 12.1548 4.43123 12.2965 4.5729C12.4382 4.71457 12.6173 4.7854 12.834 4.7854Z" fill="#666D80"/></g></svg>' },
        { name: "Well-being", svg: '<svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 25 25" fill="none"><mask id="mask0_156_4021" style="maskType: alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="25" height="25"><rect x="0.833984" y="0.5354" width="24" height="24" fill="#D9D9D9"/></mask><g mask="url(#mask0_156_4021)"><path d="M6.33359 12.9354L2.43359 9.0354L6.33359 5.1354L10.2336 9.0354L6.33359 12.9354ZM9.83359 22.5354V17.5354C8.81693 17.4521 7.80859 17.3312 6.80859 17.1729C5.80859 17.0146 4.81693 16.8021 3.83359 16.5354L4.33359 14.5354C5.73359 14.9187 7.13776 15.1812 8.54609 15.3229C9.95443 15.4646 11.3836 15.5354 12.8336 15.5354C14.2836 15.5354 15.7128 15.4646 17.1211 15.3229C18.5294 15.1812 19.9336 14.9187 21.3336 14.5354L21.8336 16.5354C20.8503 16.8021 19.8586 17.0146 18.8586 17.1729C17.8586 17.3312 16.8503 17.4521 15.8336 17.5354V22.5354H9.83359ZM6.33359 10.1354L7.43359 9.0354L6.33359 7.9354L5.23359 9.0354L6.33359 10.1354ZM12.8336 7.5354C12.0003 7.5354 11.2919 7.24373 10.7086 6.6604C10.1253 6.07707 9.83359 5.36873 9.83359 4.5354C9.83359 3.70207 10.1253 2.99373 10.7086 2.4104C11.2919 1.82707 12.0003 1.5354 12.8336 1.5354C13.6669 1.5354 14.3753 1.82707 14.9586 2.4104C15.5419 2.99373 15.8336 3.70207 15.8336 4.5354C15.8336 5.36873 15.5419 6.07707 14.9586 6.6604C14.3753 7.24373 13.6669 7.5354 12.8336 7.5354ZM12.8336 14.5354C12.2836 14.5354 11.8128 14.3396 11.4211 13.9479C11.0294 13.5562 10.8336 13.0854 10.8336 12.5354C10.8336 11.9854 11.0294 11.5146 11.4211 11.1229C11.8128 10.7312 12.2836 10.5354 12.8336 10.5354C13.3836 10.5354 13.8544 10.7312 14.2461 11.1229C14.6378 11.5146 14.8336 11.9854 14.8336 12.5354C14.8336 13.0854 14.6378 13.5562 14.2461 13.9479C13.8544 14.3396 13.3836 14.5354 12.8336 14.5354ZM12.8336 5.5354C13.1169 5.5354 13.3544 5.43957 13.5461 5.2479C13.7378 5.05623 13.8336 4.81873 13.8336 4.5354C13.8336 4.25207 13.7378 4.01457 13.5461 3.8229C13.3544 3.63123 13.1169 3.5354 12.8336 3.5354C12.5503 3.5354 12.3128 3.63123 12.1211 3.8229C11.9294 4.01457 11.8336 4.25207 11.8336 4.5354C11.8336 4.81873 11.9294 5.05623 12.1211 5.2479C12.3128 5.43957 12.5503 5.5354 12.8336 5.5354ZM17.8836 12.5354L16.1836 9.5354L17.8836 6.5354H21.2836L22.9836 9.5354L21.2836 12.5354H17.8836ZM19.0336 10.5354H20.1336L20.6836 9.5354L20.1336 8.5354H19.0336L18.4836 9.5354L19.0336 10.5354Z" fill="#666D80"/></g></svg>' },
        { name: "For couples", svg: '<svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 25 25" fill="none"><mask id="mask0_156_4033" style="maskType: alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="25" height="25"><rect x="0.833984" y="0.5354" width="24" height="24" fill="#D9D9D9"/></mask><g mask="url(#mask0_156_4033)"><path d="M18.834 6.5354C18.284 6.5354 17.8132 6.33957 17.4215 5.9479C17.0298 5.55623 16.834 5.0854 16.834 4.5354C16.834 3.9854 17.0298 3.51457 17.4215 3.1229C17.8132 2.73123 18.284 2.5354 18.834 2.5354C19.384 2.5354 19.8548 2.73123 20.2465 3.1229C20.6382 3.51457 20.834 3.9854 20.834 4.5354C20.834 5.0854 20.6382 5.55623 20.2465 5.9479C19.8548 6.33957 19.384 6.5354 18.834 6.5354ZM17.834 22.5354V14.5354C17.834 13.8687 17.6632 13.2687 17.3215 12.7354C16.9798 12.2021 16.5423 11.7854 16.009 11.4854L16.884 8.9104C17.0173 8.49373 17.2632 8.1604 17.6215 7.9104C17.9798 7.6604 18.384 7.5354 18.834 7.5354C19.284 7.5354 19.6882 7.6604 20.0465 7.9104C20.4048 8.1604 20.6507 8.49373 20.784 8.9104L23.334 16.5354H20.834V22.5354H17.834ZM13.334 12.0354C12.9173 12.0354 12.5632 11.8896 12.2715 11.5979C11.9798 11.3062 11.834 10.9521 11.834 10.5354C11.834 10.1187 11.9798 9.76457 12.2715 9.4729C12.5632 9.18123 12.9173 9.0354 13.334 9.0354C13.7507 9.0354 14.1048 9.18123 14.3965 9.4729C14.6882 9.76457 14.834 10.1187 14.834 10.5354C14.834 10.9521 14.6882 11.3062 14.3965 11.5979C14.1048 11.8896 13.7507 12.0354 13.334 12.0354ZM6.33398 6.5354C5.78398 6.5354 5.31315 6.33957 4.92148 5.9479C4.52982 5.55623 4.33398 5.0854 4.33398 4.5354C4.33398 3.9854 4.52982 3.51457 4.92148 3.1229C5.31315 2.73123 5.78398 2.5354 6.33398 2.5354C6.88398 2.5354 7.35482 2.73123 7.74648 3.1229C8.13815 3.51457 8.33398 3.9854 8.33398 4.5354C8.33398 5.0854 8.13815 5.55623 7.74648 5.9479C7.35482 6.33957 6.88398 6.5354 6.33398 6.5354ZM4.33398 22.5354V15.5354H2.83398V9.5354C2.83398 8.9854 3.02982 8.51457 3.42148 8.1229C3.81315 7.73123 4.28398 7.5354 4.83398 7.5354H7.83398C8.38398 7.5354 8.85482 7.73123 9.24648 8.1229C9.63815 8.51457 9.83398 8.9854 9.83398 9.5354V15.5354H8.33398V22.5354H4.33398ZM11.834 22.5354V18.5354H10.834V14.5354C10.834 14.1187 10.9798 13.7646 11.2715 13.4729C11.5632 13.1812 11.9173 13.0354 12.334 13.0354H14.334C14.7507 13.0354 15.1048 13.1812 15.3965 13.4729C15.6882 13.7646 15.834 14.1187 15.834 14.5354V18.5354H14.834V22.5354H11.834Z" fill="#666D80"/></g></svg>' },
        { name: "Cultural", svg: '<svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 25 25" fill="none"><mask id="mask0_156_4045" style="maskType: alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="25" height="25"><rect x="0.833984" y="0.5354" width="24" height="24" fill="#D9D9D9"/></mask><g mask="url(#mask0_156_4045)"><path d="M10.584 22.5354L8.88398 19.5354H5.58398L3.33398 15.5354L5.03398 12.5354L3.33398 9.5354L5.58398 5.5354H8.88398L10.584 2.5354H15.084L16.784 5.5354H20.084L22.334 9.5354L20.634 12.5354L22.334 15.5354L20.084 19.5354H16.784L15.084 22.5354H10.584ZM16.784 11.5354H18.934L20.034 9.5354L18.934 7.5354H16.784L15.659 9.5354L16.784 11.5354ZM11.784 14.5354H13.884L15.009 12.5354L13.884 10.5354H11.784L10.659 12.5354L11.784 14.5354ZM11.784 8.5354H13.884L15.034 6.5104L13.909 4.5354H11.759L10.634 6.5104L11.784 8.5354ZM6.75898 11.5354H8.88398L10.009 9.5354L8.88398 7.5354H6.75898L5.63398 9.5354L6.75898 11.5354ZM6.75898 17.5354H8.88398L10.009 15.5354L8.88398 13.5354H6.73398L5.63398 15.5354L6.75898 17.5354ZM11.759 20.5354H13.909L15.034 18.5604L13.884 16.5354H11.784L10.634 18.5604L11.759 20.5354ZM16.784 17.5354H18.909L20.034 15.5354L18.909 13.5354H16.784L15.659 15.5354L16.784 17.5354Z" fill="#666D80"/></g></svg>' }
    ];

    useEffect(() => {
        const fetchEvents = async () => {
            setIsLoading(true);

            // Access search parameters using useSearchParams
            const resolvedParams: SearchParams = {
                location: searchParams.location || undefined,
                openingTime: searchParams.openingTime || undefined,
                feature: searchParams.feature || undefined,
                page: searchParams.page || "1",
            };

            const params = new URLSearchParams();
            if (resolvedParams.location) params.append("location", resolvedParams.location);
            if (resolvedParams.openingTime) params.append("openingTime", resolvedParams.openingTime);
            if (resolvedParams.feature) params.append("feature", resolvedParams.feature);
            if (resolvedParams.page) params.append("page", resolvedParams.page);

            try {
                const response = await fetch(
                    `https://elite-experience-backend.onrender.com/api/events/all?${params.toString()}`
                );
                const result = await response.json();
                setData(result);
            } catch (error) {
                console.error("Failed to fetch events:", error);
                setData({ events: [], countTotalEvents: 0 }); // Fallback to an empty state
            } finally {
                setIsLoading(false);
            }
        };

        fetchEvents();
    }, [searchParams]);

    const renderCards = () => {
        if (isLoading) {
            return Array(12).fill(0).map((_, index) => <ActivityCardSkeleton key={index} />);
        }

        if (!data || !data.events || data.events.length === 0) {
            return <p>No events found.</p>;
        }

        return data.events.map((item: Event) => (
            <ActivityCard
                key={item._id}
                link={`/events/${item.slug}`}
                hideBottom={true}
                title={item.name}
                persons={item.persons}
                hours={item.time}
                distance="5"
                location={item.location}
                images={item.images}
            />
        ));
    };

    const totalEvents = data?.countTotalEvents || 0;
    const currentPage = parseInt(searchParams.page || "1");

    return (
        <>
            <ExperienceHero values={[{ name: "Location", value: ["Courchevel 1850", "Courchevel 1650", "Courchevel 1550", "Le Praz", "Meribel", "Val Thorens"] }, { name: "Opening Time", value: ["Day time", "Night time"] }]} page="events" image="event.jpg" text="Experience Events That Spark Lasting Memories" />

            <section className='sm:mt-[100px] mt-[120px] mb-16 md:mb-12 mb-10'>
                <div className='w-full h-[1px] bg-[#e3e3e3] sm:mb-[30px] mb-[20px]'></div>
                <div className="container ">
                    <div className="sm:mb-[30px] mb-[20px] flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 sm:gap-[32px]">
                        <div className="overflow-hidden w-full">
                            <RestaurantIconsFilter icons={icons} />
                        </div>
                        <div className="sm:w-auto w-full sm:block flex justify-end">
                            <CountResults number={data?.events?.length || 0} />
                        </div>
                    </div>
                </div>
                <div className="container">
                    <div className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 xl:grid-cols-4 gap-4">
                        {renderCards()}
                    </div>
                    {currentPage * 12 < totalEvents && <SeeMore />}
                </div>
            </section>
            <section className="mt-[50px] sm:mt-[62px] md:mt-[75px] lg:mt-[90px]">
                <ActivitySlider heading="Suggested Events" showSubheading={true} current="events" />
            </section>
            <MagazineListing bgColor={false} />
        </>
    );
}